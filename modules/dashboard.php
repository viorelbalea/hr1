<?php$dashboard_employees = Dashboard::getEmployees();$dashboard_tickets = Dashboard::countTickets();//$budgets = Dashboard::getBudgetDepartments();Dashboard::generateTotalGraph($CompanyID = 0);//Utils::pa($budgets);$alerts = Alert::getPersonAlerts($_SESSION['PERS']);// Utils::pa($alerts);$year = date('Y');$months = Utils::getMonthArray($year . '-01-01', $year . '-12-31');$smarty->assign(array(    'dashboard_employees' => $dashboard_employees,    'dashboard_tickets' => $dashboard_tickets,    'alerts' => $alerts,    'months' => $months,    'year' => $year,    'status' => ConfigData::$msStatus,));$status = Person::$msStatus;$contract_type = PayRoll::$msContractType;$self = Company::getSelfCompanies();$departments = Utils::getDepartments();$subdepartments = Utils::getSubDepartments();$divisions = Utils::getDivisions();// Report structure$smarty->assign(array(    'status' => $status,    //'substatus'        => Person::$msSubStatus,    'contract_type' => $contract_type,    'self' => $self,    'departments' => $departments,    'subdepartments' => $subdepartments,    'divisions' => $divisions,    'fields' => $fields_final[$reportID],    'personalise' => false,    'request_uri' => isset($_GET['order_by']) ? substr($_SERVER['REQUEST_URI'], 0, strpos($_SERVER['REQUEST_URI'], '&order_by=')) : (isset($_GET['page']) ? substr($_SERVER['REQUEST_URI'], 0, strpos($_SERVER['REQUEST_URI'], '&page=')) : $_SERVER['REQUEST_URI']),));// Vacations$reportID = 49;$_GET['Aprove'] = 0;$_GET['StartDate'] = date("d-m-Y");$_GET['EndDate'] = date("d-m-Y");$vacations = Reports::getReports_49();$employees = Person::getEmployees();$fields_final = $fields = array();$fields = Utils::getReportPersonalization($reportID);if (empty($fields['names'])) {    $fields['names'][] = array("name" => 'FullName', "label" => 'Nume');    $fields['names'][] = array("name" => 'Companie', "label" => 'Companie', 'column' => 'CompanyID');    $fields['names'][] = array("name" => 'DivisionID', "label" => 'Divizie');    $fields['names'][] = array("name" => 'Department', "label" => 'Departament');    //$fields['names'][] = array("name" => 'SubDepartmentID', "label" => 'Subdepartament');    $fields['names'][] = array("name" => 'VacationStartDate', "label" => 'Data inceput');    $fields['names'][] = array("name" => 'VacationStopDate', "label" => 'Data sfarsit');    //$fields['names'][] = array("name" => 'Type', "label" => 'Tip');    $fields['names'][] = array("name" => 'VacationStatus', "label" => 'Status', 'column' => 'Aprove');    //$fields['names'][] = array("name" => 'Details', "label" => 'Detalii');    $fields['names'][] = array("name" => 'Replacer', "label" => 'Inlocuitor');}if (empty($fields['order'])) {    for ($i = 0; $i < count($fields['names']); $i++) {        $fields['order'][$i] = array('field_id' => $i, 'visible' => true, 'position' => $i + 1);    }}if (!empty($vacations))    foreach ($vacations as $i => $data) {        foreach ($fields['order'] as $v) {            $k = $fields['names'][$v['field_id']]['name'];            $col = (!empty($fields['names'][$v['field_id']]['column'])) ? $fields['names'][$v['field_id']]['column'] : $fields['names'][$v['field_id']]['name'];            if ($col == 'CompanyID') {                $fields['data'][$i][$k] = $self[$data[$col]];                continue;            }            if ($col == 'DivisionID') {                $fields['data'][$i][$k] = $divisions[$data[$col]];                continue;            }            /*			if($col == 'SubDepartmentID'){				$fields['data'][$i][$k] = $subdepartments[$data[$col]];				continue;			}            */            if ($col == 'Replacer') {                $fields['data'][$i][$k] = $employees[$data[$col]];                continue;            }            if ($col == 'Aprove') {                switch ($data[$col]) {                    case '-1':                        $vacationStatus = 'Respins';                        break;                    case '1':                        $vacationStatus = 'Aprobat';                        break;                    case '0':                    default:                        $vacationStatus = 'Neaprobat';                        break;                }                $fields['data'][$i][$k] = $vacationStatus;                continue;            }            if (in_array($col, array('VacationStartDate', 'VacationStopDate'))) {                $fields['data'][$i][$k] = (!empty($data[$col]) && $data[$col] != '00.00.0000') ? $data[$col] : '-';                continue;            }            $fields['data'][$i][$k] = $data[$col];        }    }$_SESSION['report_fields_names'][$reportID] = $fields['names'];if (empty($_SESSION['report_fields_order'][$reportID]))    $_SESSION['report_fields_order'][$reportID] = $fields['order'];foreach ($_SESSION['report_fields_order'][$reportID] as $k => $v) {    if ($v['visible'])        $fields_final[] = $fields['names'][$v['field_id']];}//Utils::pa($vacations);$smarty->assign(array(    'fields_data_vacations' => $fields['data'],    'vacations' => $vacations,    'fields_vacations' => $fields_final,    'employees' => $employees,));$center_file = 'dashboard.tpl';?>